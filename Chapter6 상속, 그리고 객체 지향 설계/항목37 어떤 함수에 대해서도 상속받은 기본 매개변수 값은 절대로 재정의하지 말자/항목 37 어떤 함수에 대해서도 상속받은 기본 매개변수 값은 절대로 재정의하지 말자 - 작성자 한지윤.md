# í•­ëª© 37: ì–´ë–¤ í•¨ìˆ˜ì— ëŒ€í•´ì„œë„ ìƒì†ë°›ì€ ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ì€ ì ˆëŒ€ë¡œ ì¬ì •ì˜í•˜ì§€ ë§ì - ì‘ì„±ì: í•œì§€ìœ¤

<aside>
ğŸ”

# ì´ê²ƒë§Œì€ ìŠì§€ë§ì!

- ìƒì†ë°›ì€ ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ì€ ì ˆëŒ€ë¡œ ì¬ì •ì˜í•´ì„œëŠ” ì•ˆë©ë‹ˆë‹¤.
ì™œëƒí•˜ë©´ ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ì€ ì •ì ìœ¼ë¡œ ë°”ì¸ë”©ë˜ëŠ” ë°˜ë©´, ê°€ìƒ í•¨ìˆ˜(ì—¬ëŸ¬ë¶„ì´ ì˜¤ë²„ë¼ì´ë“œ í•  ìˆ˜ ìˆëŠ” ìœ ì¼í•œ í•¨ìˆ˜ì£ )ëŠ” ë™ì ìœ¼ë¡œ ë°”ì¸ë”©ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
</aside>

---

- C++ì—ì„œ í•¨ìˆ˜ë¥¼ ìƒì† ë°›ëŠ” ê²½ìš°ëŠ” ê°€ìƒ, ë¹„ ê°€ìƒ í•¨ìˆ˜
    - 36ì¥ì—ì„œ ë¹„ê°€ìƒí•¨ìˆ˜ëŠ” ì¬ì •ì˜ í•˜ì§€ ë§ìê³  í–ˆìœ¼ë‹ˆ ì´ë²ˆ ì¥ì€ â€˜ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ì„ ê°€ì§„ ê°€ìƒ í•¨ìˆ˜ë¥¼ ìƒì†í•˜ëŠ” ê²½ìš°'ì— ëŒ€í•œ ì´ì•¼ê¸°
- 37ì¥ì˜ ì œëª©ì˜ ì´ìœ ëŠ” **ê°€ìƒ í•¨ìˆ˜ëŠ” dynamically(late) binding ë˜ì§€ë§Œ, ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ì€ static (early) bindingì´ ë˜ê¸° ë•Œë¬¸**
- C++ì—ì„œ ìƒì†ë˜ëŠ” í•¨ìˆ˜ â†’ **ê°€ìƒ í•¨ìˆ˜(virtual)**
- ê°€ìƒ í•¨ìˆ˜ í˜¸ì¶œì€ **ë™ì  ë°”ì¸ë”©**
    - ì§€ì—° ë°”ì¸ë”©(**late binding**) ì´ë¼ê³  ë¶ˆë¦¬ê¸°ë„ í•¨
- ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ì€ **ì •ì  ë°”ì¸ë”©**
    - ì„ í–‰ ë°”ì¸ë”©(**early binding**) ì´ë¼ê³  ë¶ˆë¦¬ê¸°ë„ í•¨
- ğŸ‘‰ ì„œë¡œ ë‹¤ë¥¸ ë°”ì¸ë”© ë°©ì‹ì´ ì¶©ëŒí•  ìˆ˜ ìˆìŒ

# ì˜ˆì œ ì½”ë“œ

```cpp
class Shape {
public:
    enum ShapeColor { Red, Green, Blue };

    // ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ = Red
    virtual void draw(ShapeColor color = **Red**) const = 0;
};

class Rectangle : public Shape {
public:
    // ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ = Green (ë¬¸ì œ ë°œìƒ!!)
    virtual void draw(ShapeColor color = **Green**) const;
};

class Circle : public Shape {
public:
    virtual void draw(ShapeColor color) const;
};
```

```cpp
Shape *ps; *//Static type = Shape**
Shape *pc = new Circle; *//Static type = Shape**
Shape *pr = new Rectangle; *//Static type = Shape**

pr->draw();  // â“ Redì¼ê¹Œ Greenì¼ê¹Œ?
```

- **ì •ì  íƒ€ì…(Shape*)** â†’ ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ì€ `Red`
- **ë™ì  íƒ€ì…(Rectangle*)** â†’ ì‹¤ì œ ë™ì‘ì€ Rectangleì˜ `draw()`
- ê²°ê³¼: **ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ ê°’ì€ Red, í•¨ìˆ˜ ë™ì‘ì€ Rectangle**
- Static Type
    - ì†ŒìŠ¤ì— ì„ ì–¸í•´ ë†“ì€ ì„ ì–¸ë¬¸ì„ í†µí•´ ê°–ê²Œ ë˜ëŠ” íƒ€ì…
    - ps, pc, pr ëª¨ë‘ Shape*ì´ì§€ë§Œ ì§„ì§œë¡œ ê°€ë¦¬í‚¤ëŠ” typeì€ ì—†ë‹¤.
- Dynamic Type
    - ê°ì²´ê°€ ì§„ì§œë¡œ ê°€ë¦¬í‚¤ëŠ” ê²ƒì´ ë¬´ì—‡ì´ëƒì— ë”°ë¼ ê²°ì •ì´ ë¨ (RTTI)
    - ì´ ê°ì²´ê°€ ì–´ë–»ê²Œ ë™ì‘ í•  ê²ƒì´ëƒ
    - pcëŠ” circle, prì€ rectangle, psëŠ” ì—†ìŒ
    - ë‹¤ìŒê³¼ ê°™ì´ í•˜ë©´ psê°€ ê°ì²´ë¥¼ ê°€ì§€ê²Œ ë¨
    `ps = pc;` 
    `ps = pr;`
- `pr->draw();`
    - drawí•¨ìˆ˜ëŠ” Rectangleì˜ ìˆëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œ í•  ê²ƒì„ â†’ ì‹¤ì§ˆì ìœ¼ë¡œ rectangleì´ê¸° ë•Œë¬¸
    - í•˜ì§€ë§Œ default argumentëŠ” ì •ì ìœ¼ë¡œ ì„ ì–¸ì´ ëœ shapeì—ì„œ ê°€ì§€ê³  ì˜¤ê²Œ ë¨.
    - ì´ëŠ” pointerì˜ ë¬¸ì œëŠ” ì•„ë‹˜. Referenceë¡œ ë°›ì•„ë„ ë™ì¼í•˜ê²Œ ë°œìƒí•¨
    - â†’ ì´ëŸ° ë°©ì‹ì„ ê³ ì§‘í•˜ëŠ” ì´ìœ ëŠ” compilerì˜ íš¨ìœ¨ì„± ë•Œë¬¸ (default argë¥¼ ì œëŒ€ë¡œ ê°€ì§€ê³  ì˜¤ë ¤ë©´ ê´€ë ¨ ì •ë³´ë¥¼ compilerê°€ ì•Œì•„ì•¼ í•¨)
- ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ ì§œì•¼ í• ê¹Œ?
    
    ```cpp
    class Shape{
    public:
        enum ShapeColor {Rec, Green, Blue};
        
        //Should be implemented in derived
        virtual void draw(ShapeColor color = Red) cosnt = 0;
        ...
    };
    
    class Rectangle: public Shape {
    public:
      virtual void draw(ShapeColor color = Red) const;
    };
    ```
    
    â†’ ì´ëŸ¬í•œ ë°©ì‹ì€ ì„ í˜¸ë˜ì§€ ì•ŠëŠ”ë‹¤. ì½”ë“œ ì¤‘ë³µ, ê·¸ë¦¬ê³  default argumentë¥¼ ë°”ê¾¸ë ¤ë©´ ëª¨ë“  íŒŒìƒ í´ë˜ìŠ¤ë¥¼ ë‹¤ ê±´ë“œë ¤ì•¼ í•œë‹¤.
    
    - Non-virtual interface idiom
        - íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì¬ì •ì˜ í•  ìˆ˜ ìˆëŠ” ê°€ìƒ í•¨ìˆ˜ë¥¼ private
        - ì´ ê°€ìƒí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” ë¹„ ê°€ìƒí•¨ìˆ˜ë¥¼ Base classì—
        
        ```cpp
        //NVI idiom
        class Shape{
        public:
            enum ShapeColor {Rec, Green, Blue};
          
            void draw(ShapeColor color = Red) cosnt {
              doDraw(color);
            }
            ...
        private:
          //Should be implemented in derived
          virtual void doDraw(ShapeColor color) const = 0;
        };
        
        class Rectangle: public Shape {
        public:
          ...
        private:
          virtual void doDraw(ShapeColor color) const;
        };
        ```